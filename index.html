
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <title>Student Subject Result</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet"/>
  <style>
    /* Same styles as before */
    body {
      margin: 0;
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(to right, #d8eefe, #e0f7fa);
      padding: 20px;
    }
    .header {
      text-align: center;
      margin-bottom: 30px;
      background: linear-gradient(to right, #ffe4e6, #3b82f6);
      padding: 25px 10px;
      border-radius: 20px;
      box-shadow: 0 5px 20px rgba(0,0,0,0.2);
      color: white;
    }
    .college-logo {
      width: 120px;
      height: 120px;
      margin: 0 auto 15px;
      background: white;
      border-radius: 50%;
      padding: 10px;
      box-shadow: 0 8px 25px rgba(0,0,0,0.3);
      display: flex;
      align-items: center;
      justify-content: center;
      transition: transform 0.3s;
    }
    .college-logo:hover { transform: scale(1.05); }
    .college-logo img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 50%;
    }
    .header h1 { margin: 10px 0 5px; font-size: 24px; }
    .header h3 { margin: 0; font-weight: 500; font-size: 18px; opacity: 0.95; }
    .college-location { font-size: 15px; margin-bottom: 8px; }
    .portal-title {
      background-color: #facc15;
      color: #1e293b;
      font-weight: 600;
      padding: 8px;
      border-radius: 12px;
      box-shadow: inset 0 1px 3px rgba(0,0,0,0.1);
      margin-top: 10px;
    }
    .container {
      max-width: 500px;
      margin: 30px auto;
      background: #fef9c3;
      padding: 30px;
      border-radius: 20px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.1);
      text-align: center;
    }
    select, input, button {
      margin: 10px 0;
      padding: 14px 16px;
      font-size: 15px;
      border-radius: 12px;
      border: 1px solid #cbd5e1;
      transition: 0.3s ease;
    }
    select:focus, input:focus {
      border-color: #3b82f6;
      outline: none;
      box-shadow: 0 0 5px #93c5fd;
    }
    button {
      background-color: #2563eb;
      color: white;
      font-weight: 600;
      border: none;
      cursor: pointer;
    }
    button:hover { background-color: #1d4ed8; }
    .loading-container {
      display: none;
      margin-top: 15px;
      font-size: 16px;
      font-weight: bold;
      color: #1d4ed8;
      animation: pulse 1s infinite;
    }
    @keyframes pulse {
      0% { opacity: 1; }
      50% { opacity: 0.4; }
      100% { opacity: 1; }
    }
    .result-card {
      margin-top: 25px;
      background-color: #e0f2fe;
      padding: 20px;
      border-radius: 16px;
      text-align: left;
      color: #1e3a8a;
      font-size: 16px;
      line-height: 1.6;
      border-left: 6px solid #2563eb;
      box-shadow: 0 4px 12px rgba(0,0,0,0.05);
    }
    .result-table { width: 100%; border-collapse: collapse; margin-top: 10px; }
    .result-table th { background-color: #2563eb; color: #fff; padding: 8px; border: 1px solid #cbd5e1; text-align:left; }
    .result-table td { padding: 8px; border: 1px solid #e6eef8; }
    .result-table tr:nth-child(even) { background-color: #f1f5f9; }
    .input-group {
      display: flex;
      gap: 8px;
      align-items: center;
    }
    .input-group input {
      flex: 1;
    }
    .clear-btn {
      background-color: #ef4444;
      padding: 0 12px;
      font-size: 14px;
      border-radius: 8px;
    }
    .clear-btn:hover {
      background-color: #dc2626;
    }
  </style>
</head>
<body>
<div class="header">
    <div class="college-logo">
      <img alt="College Logo" src="https://raw.githubusercontent.com/Siddaram76/student_result_website/main/logo.jpg"/>
    </div>
    <h3>Kalyana Karnataka Education Society</h3>
    <h1>MILLENNIUM COMPOSITE PRE-UNIVERSITY COLLEGE</h1>
    <p class="college-location">Kalaburgi, Karnataka</p>
    <div class="portal-title">
      <marquee behavior="scroll" direction="left" scrollamount="6">
        Unit Test &amp; Monthly Test Results
      </marquee>
    </div>
  </div>

  <div style="background-color: #fef3c7; border-left: 5px solid #f59e0b; padding: 10px; margin: 10px 0; color: #78350f; font-weight: bold;">
    ðŸ“¢ Latest Notification:
    <ul style="margin: 5px 0; padding-left: 20px;">
      <li>Unit Test Results are now available.</li>
      <li>I Govt. Test scheduled for 18th August.</li>
      <li>Other subject Unit Test Results are available soon Stay Tuned....!!</li>
    </ul>
  </div>
  <div class="container">
    <h1>Student Results</h1>
    <select id="year" onchange="updateCourses()">
  <option value="">Select Year</option>
  <option value="1">1st Year</option>
  <option value="2">2nd Year</option>
</select>

<select id="course">
  <option value="">Select Course</option>
</select>

    <select id="testType" onchange="toggleSubject()">
      <option value="">Select Test Type</option>
      <option value="Monthly">Monthly Test</option>
      <option value="Unit">Unit Test</option>
    </select>
    <select id="subject" style="display:none;"></select>
    <input type="text" id="rollNumber" placeholder="Enter Roll Number" />
    <button onclick="getResult()">Get Result</button>
    <div id="results"></div>
  </div>

  <script>
    const sheetId = "1QT6ipufgUfd-nLr5tm5yro7FEhuiHg-jf_0alnJKI8c";
    const apiKey = "AIzaSyDF9StQ_lOLDxPEzvj7c2I9oJSD0yE5-tk";

    function toggleSubject() {
      const testType = document.getElementById("testType").value;
      const course = document.getElementById("course").value;
      const subjectSelect = document.getElementById("subject");
      subjectSelect.innerHTML = "";
      if (testType === "Unit") {
        subjectSelect.style.display = "block";
        if (course.includes("Science")) {
          subjectSelect.innerHTML = `<option value="PCMB">PCMB</option><option value="ComputerScience">Computer Science</option>`;
        } else if (course.includes("Commerce")) {
          subjectSelect.innerHTML = `<option value="Accountancy">Accountancy</option><option value="BusinessStudies">Business Studies</option>`;
        }
      } else {
        subjectSelect.style.display = "none";
      }
    }

    function getSheetName(year, course, testType, subject) {
      if (testType === "Monthly") {
        if (year === "1" && course === "Science1") return "1_Monthly_Science1";
        if (year === "2" && course === "Science2") return "2_Monthly_Science2";
        if (year === "1" && course === "Commerce1") return "1_Monthly_Commerce1";
        if (year === "2" && course === "Commerce2") return "2_Monthly_Commerce2";
      }
      if (testType === "Unit") {
        if (year === "1" && course === "Science1" && subject === "PCMB") return "1_PCMB_Unit";
        if (year === "2" && course === "Science2" && subject === "PCMB") return "2_PCMB_Unit";
        if (year === "1" && course === "Science1" && subject === "ComputerScience") return "1_Computer_Unit";
        if (year === "2" && course === "Science2" && subject === "ComputerScience") return "2_Computer_Unit";
        if (year === "1" && course === "Commerce1" && subject === "Accountancy") return "1_Accountancy";
        if (year === "2" && course === "Commerce2" && subject === "Accountancy") return "2_Accountancy";
        if (year === "2" && course === "Commerce2" && subject === "BusinessStudies") return "2_Business";
      }
      return null;
    }
function updateCourses() {
  const year = document.getElementById("year").value;
  const courseSelect = document.getElementById("course");
  courseSelect.innerHTML = "<option value=''>Select Course</option>";

  if (year === "1") {
    courseSelect.innerHTML += "<option value='Science1'>Science 1</option>";
    courseSelect.innerHTML += "<option value='Commerce1'>Commerce 1</option>";
  } else if (year === "2") {
    courseSelect.innerHTML += "<option value='Science2'>Science 2</option>";
    courseSelect.innerHTML += "<option value='Commerce2'>Commerce 2</option>";
  }
}


    async function getResult() {
      const year = document.getElementById("year").value;
      const course = document.getElementById("course").value;
      const testType = document.getElementById("testType").value;
      const subject = document.getElementById("subject").value;
      const rollNumber = document.getElementById("rollNumber").value.trim().toUpperCase();
      
      const sheetName = getSheetName(year, course, testType, subject);
      if (!sheetName) {
        document.getElementById("results").innerHTML = `<p style='color:red;'>Invalid selection or missing mapping.</p>`;
        return;
      }

      const url = `https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/${sheetName}?key=${apiKey}`;
      try {
        const res = await fetch(url);
        const data = await res.json();
        if (!data.values) {
          document.getElementById("results").innerHTML = `<p style='color:red;'>No data found.</p>`;
          return;
        }
        const headers = data.values[0];
        const rows = data.values.slice(1);
        const student = rows.find(r => r[0] === rollNumber);
        if (!student) {
          document.getElementById("results").innerHTML = `<p style='color:red;'>No results found for Roll Number ${rollNumber}</p>`;
          return;
        }
        let tableRows = "";
        headers.forEach((h, i) => {
          tableRows += `<tr><th>${h}</th><td>${student[i] || ''}</td></tr>`;
        });
        document.getElementById("results").innerHTML = `<div class='result-card'><table>${tableRows}</table></div>`;
      } catch (err) {
        document.getElementById("results").innerHTML = `<p style='color:red;'>Error fetching data: ${err}</p>`;
      }
    }
  </script>
<footer style="text-align:center; margin-top:40px; color:#334155; font-size:14px;">
    <hr style="margin-bottom: 10px;"/>
    <p><strong>Developed and Maintained by Siddaram Diggikar, Dept. of Computer science</strong></p>
  </footer>
</body>
</html>




<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <title>Student Subject Result</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
  <style>
    body {
      margin: 0;
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(to right, #d8eefe, #e0f7fa);
      padding: 20px;
      color: #334155;
    }
    .header {
      text-align: center;
      margin-bottom: 30px;
      background: linear-gradient(to right, #ffe4e6, #3b82f6);
      padding: 25px 10px;
      border-radius: 20px;
      box-shadow: 0 5px 20px rgba(0,0,0,0.15);
      color: white;
      border: 1px solid rgba(255, 255, 255, 0.2);
    }
    .college-logo {
      width: 120px;
      height: 120px;
      margin: 0 auto 15px;
      background: white;
      border-radius: 50%;
      padding: 10px;
      box-shadow: 0 8px 25px rgba(0,0,0,0.2);
      display: flex;
      align-items: center;
      justify-content: center;
      transition: transform 0.3s;
    }
    .college-logo:hover { transform: scale(1.05); }
    .college-logo img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 50%;
    }
    .header h1 { margin: 10px 0 5px; font-size: 24px; text-shadow: 1px 1px 3px rgba(0,0,0,0.2); }
    .header h3 { margin: 0; font-weight: 500; font-size: 18px; opacity: 0.95; }
    .college-location { font-size: 15px; margin-bottom: 8px; }
    .portal-title {
      background-color: #facc15;
      color: #1e293b;
      font-weight: 600;
      padding: 8px;
      border-radius: 12px;
      box-shadow: inset 0 1px 3px rgba(0,0,0,0.1);
      margin-top: 15px;
    }
    .notification-bar {
      max-width: 800px;
      margin: 0 auto 30px;
      background-color: #fef3c7;
      border-left: 5px solid #f59e0b;
      padding: 15px 20px;
      color: #78350f;
      font-weight: bold;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.05);
    }
    .notification-bar ul { margin: 8px 0 0; padding-left: 20px; }
    .container {
      max-width: 550px;
      margin: 30px auto;
      background: #fef9c3;
      padding: 30px;
      border-radius: 20px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.1);
      text-align: center;
    }
    .container h1 {
        margin-bottom: 25px;
        color: #4a5568;
    }
    .form-grid {
        display: grid;
        grid-template-columns: 1fr;
        gap: 15px;
    }
    select, input {
      width: 100%;
      padding: 14px 16px;
      font-size: 15px;
      border-radius: 12px;
      border: 1px solid #cbd5e1;
      transition: 0.3s ease;
      box-sizing: border-box;
    }
    select:focus, input:focus {
      border-color: #3b82f6;
      outline: none;
      box-shadow: 0 0 5px #93c5fd;
    }
    .button-group {
        display: flex;
        gap: 10px;
        margin-top: 10px;
    }
    button {
      flex: 1;
      padding: 14px 16px;
      font-size: 16px;
      border-radius: 12px;
      font-weight: 600;
      border: none;
      cursor: pointer;
      transition: 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }
    .submit-btn {
      background-color: #2563eb;
      color: white;
    }
    .submit-btn:hover { background-color: #1d4ed8; }
    .clear-btn {
      background-color: #ef4444;
      color: white;
    }
    .clear-btn:hover { background-color: #dc2626; }
    .loading-container {
      display: none;
      margin-top: 20px;
      font-size: 16px;
      font-weight: bold;
      color: #1d4ed8;
      animation: pulse 1.5s infinite;
    }
    @keyframes pulse {
      0% { opacity: 1; transform: scale(1); }
      50% { opacity: 0.6; transform: scale(1.05); }
      100% { opacity: 1; transform: scale(1); }
    }
    .result-card {
      margin-top: 25px;
      background-color: #e0f2fe;
      padding: 20px;
      border-radius: 16px;
      text-align: left;
      color: #1e3a8a;
      line-height: 1.6;
      border-left: 6px solid #2563eb;
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
    }
    .result-table { width: 100%; border-collapse: collapse; margin-top: 10px; }
    .result-table th { background-color: #bee3f8; color: #2a4365; padding: 10px; border: 1px solid #a4cafe; text-align:left; font-weight: 600; }
    .result-table td { padding: 10px; border: 1px solid #e6eef8; }
    .result-table tr:nth-child(even) { background-color: #f1f5f9; }
    footer { text-align:center; margin-top:40px; color:#334155; font-size:14px; }
  </style>
</head>
<body>
<div class="header">
    <div class="college-logo">
      <img alt="College Logo" src="https://raw.githubusercontent.com/Siddaram76/student_result_website/main/logo.jpg"/>
    </div>
    <h3>Kalyana Karnataka Education Society</h3>
    <h1>MILLENNIUM COMPOSITE PRE-UNIVERSITY COLLEGE</h1>
    <p class="college-location"><i class="fas fa-map-marker-alt"></i> Kalaburgi, Karnataka</p>
    <div class="portal-title">
      <marquee behavior="scroll" direction="left" scrollamount="6">
        Unit Test &amp; Monthly Test Results
      </marquee>
    </div>
  </div>

  <div class="notification-bar">
    <i class="fas fa-bell"></i> <strong>Latest Notifications:</strong>
    <ul>
      <li>Unit Test Results are now available.</li>
      <li>I Govt. Test scheduled for 18th August.</li>
      <li>Other subject Unit Test Results are available soon Stay Tuned....!!</li>
    </ul>
  </div>

  <div class="container">
    <h1><i class="fas fa-clipboard-check"></i> Student Results</h1>
    <div class="form-grid">
      <select id="year">
        <option value="">Select Year</option>
        <option value="1">1st Year</option>
        <option value="2">2nd Year</option>
      </select>
      <select id="course">
        <option value="">Select Course</option>
      </select>
      <select id="testType">
        <option value="">Select Test Type</option>
        <option value="Monthly">Monthly Test</option>
        <option value="Unit">Unit Test</option>
      </select>
      <select id="subject" style="display:none;">
        <option value="">Select Subject</option>
      </select>
      <input type="text" id="rollNumber" placeholder="Enter Roll Number" />
    </div>
    <div class="button-group">
        <button class="submit-btn"><i class="fas fa-search"></i> Get Result</button>
        <button class="clear-btn"><i class="fas fa-times"></i> Clear</button>
    </div>
    <div id="loading" class="loading-container">
        <p>Searching for your result...</p>
    </div>
    <div id="results"></div>
  </div>

  <footer>
    <hr style="margin-bottom: 10px; border-top: 1px solid #cbd5e1;"/>
    <p><strong>Developed and Maintained by Siddaram Diggikar, Dept. of Computer science</strong></p>
  </footer>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const sheetId = "1QT6ipufgUfd-nLr5tm5yro7FEhuiHg-jf_0alnJKI8c";
      const apiKey = "AIzaSyDF9StQ_lOLDxPEzvj7c2I9oJSD0yE5-tk";

      const yearSelect = document.getElementById("year");
      const courseSelect = document.getElementById("course");
      const testTypeSelect = document.getElementById("testType");
      const subjectSelect = document.getElementById("subject");
      const rollNumberInput = document.getElementById("rollNumber");
      const resultsDiv = document.getElementById("results");
      const loadingDiv = document.getElementById("loading");
      const submitBtn = document.querySelector(".submit-btn");
      const clearBtn = document.querySelector(".clear-btn");

      function toggleSubject() {
  const testType = testTypeSelect.value;
  const course = courseSelect.value;
  const year = yearSelect.value;
  subjectSelect.innerHTML = "<option value=''>Select Subject</option>";

  if (testType === "Unit") {
    subjectSelect.style.display = "block";

    if (year === "1" && course === "Science1") {
      subjectSelect.innerHTML += `<option value="ComputerScience">Computer Science</option>`;
    } else if (year === "2" && course === "Science2") {
      subjectSelect.innerHTML += `<option value="ComputerScience">Computer Science</option>`;
    } else if (year === "1" && course === "Commerce1") {
      subjectSelect.innerHTML += `
        <option value="Accountancy">Accountancy</option>
        <option value="Business">Business</option>
        <option value="Economics">Economics</option>
        <option value="ComputerScience">Computer Science</option>`;
    } else if (year === "2" && course === "Commerce2") {
      subjectSelect.innerHTML += `
        <option value="Accountancy">Accountancy</option>
        <option value="Business">Business</option>
        <option value="Economics">Economics</option>
        <option value="ComputerScience">Computer Science</option>`;
    }
  } else {
    subjectSelect.style.display = "none";
  }
}



      function getSheetName(year, course, testType, subject) {
  if (testType === "Monthly") {
    if (year === "1" && course === "Science1") return "1_Monthly_Science1";
    if (year === "2" && course === "Science2") return "2_Monthly_Science2";
    if (year === "1" && course === "Commerce1") return "1_Monthly_Commerce1";
    if (year === "2" && course === "Commerce2") return "2_Monthly_Commerce2";
  }
  if (testType === "Unit") {
    if (subject) return `${year}_${subject}`;  // Example: "1_Accountancy" or "2_ComputerScience"
  }
  return null;
}

      function updateCourses() {
        const year = yearSelect.value;
        courseSelect.innerHTML = "<option value=''>Select Course</option>";
        if (year === "1") {
          courseSelect.innerHTML += "<option value='Science1'>Science 1</option>";
          courseSelect.innerHTML += "<option value='Commerce1'>Commerce 1</option>";
        } else if (year === "2") {
          courseSelect.innerHTML += "<option value='Science2'>Science 2</option>";
          courseSelect.innerHTML += "<option value='Commerce2'>Commerce 2</option>";
        }
        toggleSubject();
      }

      function clearForm() {
          yearSelect.value = "";
          courseSelect.innerHTML = "<option value=''>Select Course</option>";
          testTypeSelect.value = "";
          subjectSelect.style.display = "none";
          subjectSelect.innerHTML = "<option value=''>Select Subject</option>";
          rollNumberInput.value = "";
          resultsDiv.innerHTML = "";
          loadingDiv.style.display = "none";
      }

      async function getResult() {
        const year = yearSelect.value;
        const course = courseSelect.value;
        const testType = testTypeSelect.value;
        const subject = subjectSelect.value;
        const rollNumber = rollNumberInput.value.trim().toUpperCase();
        
        resultsDiv.innerHTML = "";
        loadingDiv.style.display = "block";

        const sheetName = getSheetName(year, course, testType, subject);
        if (!sheetName) {
          resultsDiv.innerHTML = `<p style='color:red;'>Invalid selection. Please check all fields.</p>`;
          loadingDiv.style.display = "none";
          return;
        }
        if (!rollNumber) {
          resultsDiv.innerHTML = `<p style='color:red;'>Please enter your roll number.</p>`;
          loadingDiv.style.display = "none";
          return;
        }

        const url = `https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/${sheetName}?key=${apiKey}`;
        try {
          const res = await fetch(url);
          const data = await res.json();
          if (data.error) { throw new Error(data.error.message); }
          if (!data.values || data.values.length < 2) {
            resultsDiv.innerHTML = `<p style='color:red;'>No data found for the selected test.</p>`;
            return;
          }
          const headers = data.values[0];
          const rows = data.values.slice(1);
          const student = rows.find(r => r[0] && r[0].toUpperCase() === rollNumber);
          if (!student) {
            resultsDiv.innerHTML = `<p style='color:red;'>No results found for Roll Number <strong>${rollNumber}</strong></p>`;
            return;
          }
          let tableRows = "";
          headers.forEach((h, i) => {
            tableRows += `<tr><th>${h}</th><td>${student[i] || ''}</td></tr>`;
          });
          resultsDiv.innerHTML = `<div class='result-card'><table class="result-table">${tableRows}</table></div>`;
        } catch (err) {
          resultsDiv.innerHTML = `<p style='color:red;'>Error fetching data: ${err.message}. Please try again later.</p>`;
        } finally {
          loadingDiv.style.display = "none";
        }
      }

      // Attach event listeners
      yearSelect.addEventListener('change', updateCourses);
      testTypeSelect.addEventListener('change', toggleSubject);
      submitBtn.addEventListener('click', getResult);
      clearBtn.addEventListener('click', clearForm);
    });
  </script>
</body>
</html>
